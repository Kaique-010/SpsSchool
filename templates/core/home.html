{% extends 'base.html' %}

{% block title %}Início - SPS Training System{% endblock %}

{% block content %}
<div class="py-4">
    <!-- Hero Section -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="card border-0 bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="card-body text-white p-5">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <h1 class="display-4 fw-bold mb-3">
                                Bem-vindo ao SPS Training System
                            </h1>
                            <p class="lead mb-4">
                                Plataforma completa de treinamento corporativo com vídeos interativos, 
                                controle de progresso e certificações automáticas.
                            </p>
                            {% if not user.is_authenticated %}
                            <div class="d-flex gap-3">
                                <a href="{% url 'core:login' %}" class="btn btn-light btn-lg">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>
                                    Fazer Login
                                </a>
                                <a href="{% url 'core:modules_list' %}" class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-collection me-2"></i>
                                    Ver Módulos
                                </a>
                            </div>
                            {% else %}
                            <div class="d-flex gap-3">
                                <a href="{% url 'core:dashboard' %}" class="btn btn-light btn-lg">
                                    <i class="bi bi-speedometer2 me-2"></i>
                                    Ir para Dashboard
                                </a>
                                <a href="{% url 'core:modules_list' %}" class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-collection me-2"></i>
                                    Explorar Módulos
                                </a>
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-lg-4 text-center">
                            <i class="bi bi-play-circle display-1 opacity-75"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="row mb-5">
        <div class="col-12">
            <h2 class="text-center mb-5">Recursos da Plataforma</h2>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="mb-3">
                        <i class="bi bi-play-circle-fill text-primary" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title">Vídeos Interativos</h5>
                    <p class="card-text">
                        Player integrado com YouTube, controle de progresso automático 
                        e marcação de conclusão de vídeos.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="mb-3">
                        <i class="bi bi-collection-fill text-success" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title">Módulos Organizados</h5>
                    <p class="card-text">
                        Estrutura hierárquica de módulos e treinamentos para 
                        uma experiência de aprendizado organizada.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center p-4">
                    <div class="mb-3">
                        <i class="bi bi-award-fill text-warning" style="font-size: 3rem;"></i>
                    </div>
                    <h5 class="card-title">Certificações</h5>
                    <p class="card-text">
                        Certificados automáticos ao completar treinamentos, 
                        com controle de progresso e validação.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Section (if user is authenticated) -->
    {% if user.is_authenticated %}
    <div class="row mb-5">
        <div class="col-12">
            <h3 class="mb-4">Seu Progresso</h3>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card stats-card border-0">
                <div class="card-body text-center">
                    <i class="bi bi-collection display-6 mb-2"></i>
                    <h4 class="card-title">{{ total_modules|default:0 }}</h4>
                    <p class="card-text">Módulos Disponíveis</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card stats-card border-0">
                <div class="card-body text-center">
                    <i class="bi bi-play-circle display-6 mb-2"></i>
                    <h4 class="card-title">{{ total_trainings|default:0 }}</h4>
                    <p class="card-text">Treinamentos</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card stats-card border-0">
                <div class="card-body text-center">
                    <i class="bi bi-check-circle display-6 mb-2"></i>
                    <h4 class="card-title">{{ completed_trainings|default:0 }}</h4>
                    <p class="card-text">Concluídos</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card stats-card border-0">
                <div class="card-body text-center">
                    <i class="bi bi-award display-6 mb-2"></i>
                    <h4 class="card-title">{{ total_certificates|default:0 }}</h4>
                    <p class="card-text">Certificados</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Recent Modules Section -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3>Módulos em Destaque</h3>
                <a href="{% url 'core:modules_list' %}" class="btn btn-outline-primary">
                    Ver Todos <i class="bi bi-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
        
        {% if recent_modules %}
            {% for module in recent_modules %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card module-card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-start mb-3">
                            <div class="me-3">
                                <i class="bi bi-collection-fill text-primary" style="font-size: 2rem;"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5 class="card-title mb-1">{{ module.module.title }}</h5>
                                <small class="text-muted">{{ module.module.trainings.count }} treinamento{{ module.module.trainings.count|pluralize }}</small>
                            </div>
                        </div>
                        
                        <p class="card-text">{{ module.module.description|truncatewords:20 }}</p>
                        
                        {% if user.is_authenticated %}
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <small class="text-muted">Progresso</small>
                                <small class="text-muted">{{ module.progress|default:0 }}%</small>
                            </div>
                            <div class="progress progress-bar-custom">
                                <div class="progress-bar" role="progressbar" 
                                     style="width: {{ module.progress|default:0 }}%"></div>
                            </div>
                        </div>
                        {% endif %}
                        
                        <div class="d-flex justify-content-between align-items-center">
                            <a href="{% url 'core:module_detail' module.module.id %}" class="btn btn-primary">
                                <i class="bi bi-play-circle me-1"></i>
                                {% if user.is_authenticated %}Continuar{% else %}Ver Módulo{% endif %}
                            </a>
                            <small class="text-muted">
                                <i class="bi bi-clock me-1"></i>
                                {{ module.total_videos|default:0 }}0 min
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
        <div class="col-12">
            <div class="card border-0">
                <div class="card-body text-center py-5">
                    <i class="bi bi-collection text-muted" style="font-size: 4rem;"></i>
                    <h4 class="text-muted mt-3">Nenhum módulo disponível</h4>
                    <p class="text-muted">Os módulos de treinamento serão exibidos aqui quando estiverem disponíveis.</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- FAQ Preview -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 bg-light">
                <div class="card-body p-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="mb-2">Precisa de Ajuda?</h4>
                            <p class="mb-0 text-muted">
                                Consulte nossa seção de perguntas frequentes ou entre em contato 
                                com o suporte técnico.
                            </p>
                        </div>
                        <div class="col-md-4 text-md-end">
                            <a href="{% url 'core:faq' %}" class="btn btn-outline-primary">
                                <i class="bi bi-question-circle me-2"></i>
                                Ver FAQ
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate progress bars
    const progressBars = document.querySelectorAll('.progress-bar');
    progressBars.forEach(bar => {
        const width = bar.style.width;
        bar.style.width = '0%';
        setTimeout(() => {
            bar.style.transition = 'width 1s ease-in-out';
            bar.style.width = width;
        }, 500);
    });

    // Add hover effects to module cards
    const moduleCards = document.querySelectorAll('.module-card');
    moduleCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
            this.style.transition = 'transform 0.3s ease';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
});
</script>
{% endblock %}